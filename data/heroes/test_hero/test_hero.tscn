[gd_scene load_steps=14 format=3 uid="uid://pinfmowtm0bj"]

[ext_resource type="PackedScene" uid="uid://cn72ke0k838lf" path="res://data/heroes/base_hero.tscn" id="1_qbasj"]
[ext_resource type="Script" path="res://data/heroes/test_hero/test_hero.gd" id="2_jf5al"]
[ext_resource type="Script" path="res://data/heroes/test_hero/test_hero_attack_1_animation.gd" id="3_x2hvr"]
[ext_resource type="Texture2D" uid="uid://dts044t23auss" path="res://icon.svg" id="4_11rb4"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="5_g0qw8"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="6_7fo37"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="7_3cjcu"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="8_egamx"]

[sub_resource type="CircleShape2D" id="CircleShape2D_m1id3"]
radius = 120.037

[sub_resource type="CircleShape2D" id="CircleShape2D_5y1ys"]
radius = 180.069

[sub_resource type="SpriteFrames" id="SpriteFrames_raauo"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("4_11rb4")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_7dgsn"]
radius = 54.3323

[sub_resource type="CircleShape2D" id="CircleShape2D_5p4fc"]
radius = 660.824

[node name="TestHero" instance=ExtResource("1_qbasj")]
collision_mask = 6
script = ExtResource("2_jf5al")

[node name="HealthComponent" parent="." index="0"]
max_health = 70

[node name="CollisionShape2D" type="CollisionShape2D" parent="HurtBoxComponent" index="0"]
shape = SubResource("CircleShape2D_m1id3")

[node name="Attack1Component" parent="." index="3" node_paths=PackedStringArray("hit_animation_object")]
damage = 10.0
delay = 0.5
hit_window = 1.0
hit_animation_object = NodePath("Attack1Animation")

[node name="Attack1Zone" type="CollisionShape2D" parent="Attack1Component" index="0"]
shape = SubResource("CircleShape2D_5y1ys")

[node name="Attack1Polygon" type="Polygon2D" parent="Attack1Component" index="1"]
color = Color(1, 1, 1, 0.568627)
polygon = PackedVector2Array(-26, 188, -45, 182, -87, 168, -115, 146, -150, 124, -168, 78, -180, 38, -192, -16, -182, -59, -164, -97, -139, -131, -105, -158, -76, -173, -52, -182, -23, -191, 9, -195, 42, -185, 88, -163, 109, -153, 134, -124, 167, -99, 177, -77, 178, -43, 181, 4, 183, 45, 176, 70, 162, 97, 146, 124, 114, 153, 72, 180, 40, 188, 7, 190)

[node name="Attack1Animation" type="Node2D" parent="Attack1Component" index="2" node_paths=PackedStringArray("anim_poly")]
script = ExtResource("3_x2hvr")
anim_poly = NodePath("../Attack1Polygon")

[node name="AnimatedSprite2D" parent="." index="4"]
sprite_frames = SubResource("SpriteFrames_raauo")

[node name="CollisionShape2D" type="CollisionShape2D" parent="." index="5"]
shape = SubResource("CircleShape2D_7dgsn")

[node name="StateChart" type="Node" parent="." index="6"]
script = ExtResource("5_g0qw8")

[node name="Root" type="Node" parent="StateChart" index="0"]
script = ExtResource("6_7fo37")
initial_state = NodePath("Explore")

[node name="Explore" type="Node" parent="StateChart/Root" index="0"]
script = ExtResource("7_3cjcu")

[node name="ToAttack" type="Node" parent="StateChart/Root/Explore" index="0"]
script = ExtResource("8_egamx")
to = NodePath("../../Attack")
event = &"enemy_detected"

[node name="Attack" type="Node" parent="StateChart/Root" index="1"]
script = ExtResource("7_3cjcu")

[node name="Transition" type="Node" parent="StateChart/Root/Attack" index="0"]
script = ExtResource("8_egamx")
to = NodePath("../../Explore")
event = &"enemy_undetected"
delay_seconds = 1.3

[node name="EnemyDetectionArea" type="Area2D" parent="." index="7"]
collision_layer = 0
collision_mask = 3

[node name="Area" type="CollisionShape2D" parent="EnemyDetectionArea" index="0"]
shape = SubResource("CircleShape2D_5p4fc")

[connection signal="attack_finished" from="Attack1Component" to="." method="_on_attack_1_component_attack_finished"]
[connection signal="state_entered" from="StateChart/Root/Explore" to="." method="_on_explore_state_entered"]
[connection signal="state_exited" from="StateChart/Root/Explore" to="." method="_on_explore_state_exited"]
[connection signal="state_exited" from="StateChart/Root/Attack" to="." method="_on_attack_state_exited"]
[connection signal="state_physics_processing" from="StateChart/Root/Attack" to="." method="_on_attack_state_physics_processing"]
[connection signal="body_entered" from="EnemyDetectionArea" to="." method="_on_enemy_detected"]
[connection signal="body_exited" from="EnemyDetectionArea" to="." method="_on_enemy_undetected"]
